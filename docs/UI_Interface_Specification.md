# Ninefold Fate - UI 介面規格書

版本：v0.1  
基於：Game_SRS.md + MVP_Questionnaire.md  
更新日期：2025-10-07

---

## 一、總體 UI 設計規範

### 1.1 技術規格
- **螢幕方向**：直向 (Portrait)
- **基準解析度**：1080×1920
- **目標 FPS**：60
- **比例處理**：以 1080×1920 為基準，其他比例上下留黑/裁切
- **輸入模型**：單指拖放，吸附網格，觸控友好

### 1.2 設計原則
- **遊戲機制統一**：所有介面導航都使用拖放圖塊到九宮格的核心玩法
- **直觀的視覺語言**：圖塊顏色/形狀直接對應功能類型
- **一致的互動體驗**：從選單導航到戰鬥操作使用相同的拖放邏輯
- **視覺回饋明確**：拖放、選擇、狀態變化都有明確視覺提示
- **模組化設計**：便於後續功能擴展

### 1.3 統一分層架構
所有介面採用標準三層結構，比例重新分配：

#### 上層 - 主要資訊顯示區 (0, 0) - (1080, 1000)
**最大區域，承載主要資訊展示**：
- **主選單**：遊戲標題 + 副標題 + 遊戲介紹/背景
- **關卡選擇**：章節資訊 + 關卡詳細資訊面板 + 進度展示
- **戰鬥界面**：敵人立繪 + 詳細狀態 + 技能區 + 傷害分解 + 3×3戰鬥棋盤
- **結算畫面**：勝敗結果 + 星級評價 + 詳細統計資料 + 獎勵展示

#### 中層 - 統一互動確認區 (240, 1000) - (840, 1600)  
**放大的3×3互動區域，更易操作**：
- 九宮格尺寸：600×600px，位置居中 (240, 1000)
- 單格尺寸：200×200px，間距：0px
- 中央確認格：特殊高亮效果
- 功能：確認操作、顯示選中項目預覽
- **注意**：戰鬥場景中，這裡就是唯一的3×3戰鬥棋盤

#### 下層 - 選項圖塊區 (0, 1600) - (1080, 1920)
**緊湊區域，提供選項和簡單描述**：
- **標準圖塊**：200×200px，與棋盤格子對齊（單格尺寸相同）
- **主選單**：4個功能圖塊（戰鬥、構築、商店、設定）
- **關卡選擇**：水平滾動關卡圖塊 + 返回按鈕
- **戰鬥界面**：4個候選圖塊 + 送出/取消按鈕
- **結算畫面**：4個行動圖塊（重試、繼續、返回、分享）

---

## 二、主要場景與介面

### 2.1 主選單 (MainMenu) - **創新拖放導航**

**功能定位**：遊戲入口，使用核心玩法機制進行功能導航

**創新設計理念**：
將主選單設計為迷你版的遊戲玩法，玩家通過拖放功能圖塊到九宮格中央區域來進入對應功能。

**UI 佈局**：

#### 2.1.1 上層 - 主要資訊顯示區 (0, 0) - (1080, 1000)
- **遊戲 LOGO**：位置 (540, 200) 中心對齊，"Ninefold Fate" 標題
- **副標題/標語**：位置 (540, 300)，例如 "選擇你的命運方塊"
- **遊戲介紹區域**：位置 (540, 500)，背景 #FFFFFF20，圓角 20px
- **版本資訊**：位置 (1000, 950)，右下角顯示版本號

#### 2.1.2 中層 - 統一確認區域 (240, 1000) - (840, 1600)
- **3×3 導航網格**：600×600px，九宮格居中
- **單格尺寸**：200×200px，無間距
- **中央確認格**：特殊高亮效果，"將圖塊拖放到此處"提示
- **視覺反饋**：拖放時有吸附效果和高亮顯示

#### 2.1.3 下層 - 功能圖塊區 (0, 1600) - (1080, 1920)
- **四個功能圖塊**：水平排列，統一尺寸 200×200px
- **戰鬥圖塊**：紅色劍盾圖案，拖放進入關卡選擇
- **構築圖塊**：藍色拼圖圖案，拖放提示「敬請期待」（MVP階段預留）
- **商店圖塊**：金色錢幣圖案，拖放提示「敬請期待」（MVP階段預留）
- **設定圖塊**：灰色齒輪圖案，拖放進入設定選單

**互動流程**：
1. 玩家拖拽功能圖塊到中央九宮格
2. 圖塊吸附到中央格子，產生視覺效果
3. 短暫停留後切換到對應場景
4. 返回主選單時圖塊自動回到原位

**Godot 節點結構**：
```
MainMenu.tscn
├── CanvasLayer (背景層)
│   ├── MainInfoArea (上層主要資訊區 1000px高)
│   │   ├── GameLogo (遊戲標題)
│   │   ├── SubtitleLabel (副標題)
│   │   ├── GameIntroPanel (遊戲介紹區域)
│   │   └── VersionLabel (版本資訊)
│   └── UnifiedConfirmGrid (中層統一確認區 600x600px)
│       ├── GridContainer (3x3, 200x200px單格)
│       ├── CenterSlot (目標放置區)
│       ├── GridHighlight (高亮效果)
│       └── ConfirmButton (確認按鈕，條件顯示)
├── CanvasLayer (互動層)
│   └── OptionsArea (下層選項區 320px高)
│       └── FunctionTileContainer (四個功能圖塊)
│           ├── BattleTile (戰鬥圖塊)
│           ├── DeckBuildTile (構築圖塊)
│           ├── ShopTile (商店圖塊)
│           └── SettingsTile (設定圖塊)
└── CanvasLayer (效果層)
    ├── DragPreview
    └── TransitionEffect
```

**圖塊設計規範**：
- **統一尺寸**：與戰鬥圖塊相同大小，保持視覺一致性
- **圖標設計**：清晰的象形圖標 + 功能文字標籤
- **顏色編碼**：
  - 戰鬥：火紅色 (#FF4444)
  - 構築：海藍色 (#4488FF)
  - 商店：金黃色 (#FFD700)
  - 設定：中性灰 (#888888)

### 2.2 關卡選擇介面 (LevelSelection) - **拖放選關模式**

**功能定位**：使用圖塊拖放機制進行關卡選擇

**創新設計理念**：
將關卡選擇也融入拖放玩法，玩家拖放關卡圖塊到確認區域來開始遊戲。

**UI 佈局**：

#### 2.2.1 上層 - 主要資訊顯示區 (0, 0) - (1080, 1000)
- **章節標題**：位置 (540, 150)，當前章節名稱與編號
- **章節進度條**：位置 (540, 250)，完成關卡數 / 總關卡數
- **關卡詳細資訊面板**：位置 (540, 500)，背景 #FFFFFF20，圓角 20px
  - 關卡名稱、敵人預覽、獎勵資訊
  - 解鎖條件、建議戰力等
- **章節切換按鈕**：左右箭頭 (80, 150) 和 (1000, 150)
- **返回主選單按鈕**：位置 (80, 80)，120×80px，左上角

#### 2.2.2 中層 - 統一確認區域 (240, 1000) - (840, 1600)
- **3×3 確認網格**：600×600px，與主選單相同規格
- **單格尺寸**：200×200px，無間距
- **中央確認格**：顯示"拖放關卡圖塊開始遊戲"
- **確認/取消按鈕**：選中關卡後在九宮格下方顯示

#### 2.2.3 下層 - 關卡圖塊滾動區 (0, 1600) - (1080, 1920)
- **水平滾動容器**：支援右滑查看更多關卡
- **關卡圖塊**：統一尺寸 200×200px
- **解鎖狀態標示**：
  - 已完成：綠色邊框 + 星級顯示
  - 可挑戰：白色邊框 + 關卡編號
  - 未解鎖：灰色 + 鎖定圖示
- **難度選擇器**：位置 (540, 1880)，三個選項 (普通/困難/地獄)

**互動流程**：
1. 玩家滾動瀏覽可用關卡圖塊
2. 拖拽想要挑戰的關卡圖塊到中央確認區
3. 顯示關卡詳細資訊（敵人、獎勵、特殊規則）
4. 確認後進入戰鬥場景

**Godot 節點結構**：
```
LevelSelection.tscn
├── CanvasLayer (背景層)
│   ├── MainInfoArea (上層主要資訊區 1000px高)
│   │   ├── ChapterTitle (章節標題)
│   │   ├── ProgressBar (進度條)
│   │   ├── ChapterNavButtons (章節切換)
│   │   └── LevelDetailPanel (關卡詳細資訊面板)
│   │       ├── LevelTitle (關卡名稱)
│   │       ├── EnemyPreview (敵人預覽)
│   │       ├── RewardInfo (獎勵資訊)
│   │       ├── UnlockConditions (解鎖條件)
│   │       └── BestRecord (最佳紀錄)
│   └── UnifiedConfirmGrid (中層統一確認區 600x600px)
│       ├── GridContainer (3x3, 200x200px單格)
│       ├── CenterConfirmSlot
│       ├── LevelPreview (關卡縮略圖)
│       └── ConfirmButtons (確認/取消按鈕)
├── CanvasLayer (互動層)
│   └── OptionsArea (下層選項區 320px高)
│       ├── LevelTileContainer (ScrollContainer)
│       │   └── HBoxContainer
│       │       ├── Level1Tile
│       │       ├── Level2Tile
│       │       └── ...
│       └── BackButton (返回主選單按鈕)
└── CanvasLayer (效果層)
    ├── DragPreview
    └── TransitionEffect
```

**關卡圖塊設計**：
- **基礎樣式**：正方形圖塊，顯示關卡編號
- **難度指示**：邊框粗細代表難度
- **完成標記**：金星、銀星、銅星等級標示
- **敵人預覽**：縮小的敵人圖示顯示在圖塊角落

### 2.3 戰鬥場景 (Battle) - **核心介面**

**功能定位**：主要遊戲玩法界面

#### 2.3.1 上層 - 主要戰鬥資訊顯示區 (0, 0) - (1080, 1000)
**最大區域，包含所有主要戰鬥元素**：
- **關卡名稱**：位置 (540, 50)，當前關卡標題
- **設定按鈕**：位置 (980, 50)，80×80px，右上角固定位置
- **敵人立繪**：位置 (150, 200)，尺寸 250×250px，圓形遮罩
- **敵人詳細資訊面板**：位置 (450, 150)
  - HP 血條：500×50px，數值顯示
  - 屬性 Icon：50×50px
  - 倒數 CD 顯示：150×150px 圓形，大字顯示剩餘回合數
- **英雄技能區**：位置 (800, 200)，預留多個技能按鈕，每個80×80px
- **傷害分解顯示區**：位置 (450, 400)
  - 本回合傷害預覽：大字顯示預期傷害
  - 當前 Combo 數值：「連擊 x N」
  - 連擊倍率顯示：「倍率 x1.2」
  - 屬性加成顯示

#### 2.3.2 中層 - 3×3戰鬥棋盤區 (240, 1000) - (840, 1600)
**唯一的戰鬥棋盤，同時具備確認功能**：
- **3×3 戰鬥棋盤**：600×600px，與其他介面的九宮格相同規格
- **單格尺寸**：200×200px，無間距
- **功能**：
  - 候選圖塊拖放的目標區域
  - 障礙格標示、放置高亮
  - 已放置圖塊顯示
  - 完成拖放後的確認區域

#### 2.3.3 下層 - 候選圖塊與控制區 (0, 1600) - (1080, 1920)
**緊湊區域，候選圖塊和控制按鈕**：
- **候選圖塊區**：4個圖塊槽位，每個 200×200px，位置 (140, 1620)
  - 顯示圖塊形狀與屬性
  - 支援拖曳到中層的3×3戰鬥棋盤
  - 使用後立即補充新圖塊
- **送出按鈕**：位置 (440, 1830)，200×60px
- **取消按鈕**：位置 (680, 1830)，160×60px

**Godot 節點結構**：
```
Battle.tscn
├── CanvasLayer (背景層)
│   ├── MainBattleArea (上層主要戰鬥區 1000px高)
│   │   ├── LevelTitle (關卡名稱)
│   │   ├── SettingsButton (設定按鈕，右上角 80x80px)
│   │   ├── EnemyPanel (敵人資訊面板)
│   │   │   ├── EnemySprite (250x250px圓形)
│   │   │   ├── HPBar (500x50px)
│   │   │   ├── ElementIcon (50x50px)
│   │   │   └── CountdownLabel (150x150px圓形)
│   │   ├── HeroSkillArea (英雄技能區)
│   │   │   ├── SkillButton1 (80x80px)
│   │   │   ├── SkillButton2 (80x80px)
│   │   │   └── SkillButton3 (80x80px)
│   │   └── DamageInfoPanel (傷害分解顯示區)
│   │       ├── DamagePreview (傷害預覽)
│   │       ├── ComboDisplay (連擊顯示)
│   │       ├── MultiplierDisplay (倍率顯示)
│   │       └── ElementBonus (屬性加成)
│   └── BattleBoard (中層唯一戰鬥棋盤 600x600px)
│       ├── GridContainer (3x3, 200x200px單格)
│       ├── PlacedTiles (已放置圖塊)
│       ├── HighlightOverlay (高亮覆蓋)
│       └── DropZone (拖放區域檢測)
├── CanvasLayer (互動層)
│   └── OptionsArea (下層候選圖塊區 320px高)
│       ├── CandidateTiles (4個候選圖塊)
│       │   ├── TileSlot1 (200x200px)
│       │   ├── TileSlot2
│       │   ├── TileSlot3
│       │   └── TileSlot4
│       └── ActionButtons (操作按鈕)
│           ├── SubmitButton (200x60px)
│           └── CancelButton (160x60px)
└── CanvasLayer (浮動層)
    ├── DamageBreakdownPopup
    └── MessagePopup
```

### 2.4 結算畫面 (Result) - **拖放選擇後續行動**

**功能定位**：戰鬥結果展示，使用拖放選擇後續行動

**創新設計理念**：
結算畫面也使用拖放機制，讓玩家通過拖拽行動圖塊來選擇下一步操作。

**UI 佈局**：

#### 2.4.1 上層 - 結果展示區 (0, 0) - (1080, 1000)
- **勝利/失敗大字**：位置 (540, 150)，動畫效果的結果標題
- **星級評價**：位置 (540, 300)，3星評價系統，星星 120×120px，間距 40px
- **戰鬥統計面板**：位置 (540, 500)，背景 #FFFFFF20，圓角 20px
  - 總回合數 vs 目標回合數
  - 最大連擊數
  - 總傷害輸出
  - 剩餘 HP（勝利時）
  - 完成時間
- **獎勵展示**：位置 (540, 750)，獲得的金幣、經驗、道具等

#### 2.4.2 中層 - 統一確認區域 (240, 1000) - (840, 1600)
- **3×3 行動確認網格**：600×600px，與其他介面相同規格
- **單格尺寸**：200×200px，無間距
- **中央確認格**：顯示"選擇你的行動"
- **確認提示**：拖放行動圖塊後顯示確認效果

#### 2.4.3 下層 - 行動圖塊選擇區 (0, 1600) - (1080, 1920)
- **四個行動圖塊**：統一尺寸 200×200px，水平排列
  - **重試圖塊**：橙色重新開始圖示，重新挑戰本關
  - **繼續圖塊**：綠色前進箭頭，進入下一關（勝利時顯示）
  - **返回圖塊**：藍色返回圖示，回到關卡選擇
  - **分享圖塊**：紫色分享圖示，分享戰績（未來功能）
- **返回主選單按鈕**：左下角固定位置

**特殊互動**：
- **失敗時**：只顯示重試和返回圖塊
- **勝利時**：顯示所有可用選項
- **完美勝利時**：圖塊會有特殊光效

**Godot 節點結構**：
```
Result.tscn
├── CanvasLayer (背景層)
│   ├── MainResultArea (上層主要結果展示區 1000px高)
│   │   ├── ResultTitle (勝敗大字)
│   │   ├── StarRating (星級評價)
│   │   ├── DetailedStatsPanel (詳細戰鬥統計面板)
│   │   │   ├── TurnsDisplay (回合數統計)
│   │   │   ├── ComboDisplay (連擊統計)
│   │   │   ├── DamageDisplay (傷害統計)
│   │   │   ├── TimeDisplay (時間統計)
│   │   │   ├── SkillUsage (技能使用統計)
│   │   │   └── SpeedRating (速度評級)
│   │   └── RewardDisplay (詳細獎勵展示)
│   │       ├── CoinReward (金幣獎勵)
│   │       ├── ExpReward (經驗獎勵)
│   │       ├── ItemReward (道具獎勵)
│   │       └── UnlockNotice (解鎖提示)
│   └── UnifiedConfirmGrid (中層統一確認區 600x600px)
│       ├── GridContainer (3x3, 200x200px單格)
│       ├── CenterActionSlot
│       ├── ActionPreview (行動預覽)
│       └── ActionIndicator (行動指示)
├── CanvasLayer (互動層)
│   └── OptionsArea (下層行動選擇區 320px高)
│       ├── ActionTileContainer (四個行動圖塊)
│       │   ├── RetryTile (200x200px)
│       │   ├── NextLevelTile (條件顯示)
│       │   ├── BackToSelectTile
│       │   └── ShareTile (預留)
│       └── BackButton (返回主選單按鈕)
└── CanvasLayer (效果層)
    ├── VictoryAnimation
    └── TileEffects
```

---

## 三、UI 系統架構

### 3.1 統一拖放系統設計

**核心拖放組件**：所有場景共用的拖放邏輯
- `DragDropManager.gd`：統一的拖放管理器
- `DraggableTile.gd`：可拖拽圖塊基類
- `DropZone.gd`：投放區域基類
- `TileEffects.gd`：圖塊視覺效果管理

### 3.2 訊號流向設計

#### 3.2.1 通用拖放訊號
```
DraggableTile → DragDropManager：
- drag_started(tile_data, source_scene)
- drag_ended(tile_data, drop_zone)

DropZone → DragDropManager：
- tile_dropped(tile_data, zone_type)
- drop_validated(is_valid, target_zone)

DragDropManager → SceneManager：
- navigation_requested(target_scene, tile_type)
- action_confirmed(action_type, parameters)
```

#### 3.2.2 戰鬥場景專用訊號
```
TileBagPanel → BoardRoot：
- battle_tile_dragged(tile_data)
- battle_tile_placed(position, tile_data)

BoardRoot → DamageResolver：
- request_damage_calc(placed_tiles)
- grid_3x3_completed(positions)

DamageResolver → ActionPanel/DamageBreakdown：
- damage_calculated(damage_breakdown)
- combo_updated(combo_count)

EnemyPanel → ActionPanel/MessagePopup：
- enemy_attack(damage)
- enemy_cd_updated(countdown)

ActionPanel → BattleUI：
- turn_submitted()
- turn_end_requested()

BattleUI → Result.tscn：
- battle_completed(result_data)
```

#### 3.2.3 選單導航訊號
```
MainMenu/LevelSelection/Result → SceneTransition：
- scene_transition_requested(target_scene, transition_data)
- navigation_tile_confirmed(function_type)

SceneTransition → SceneManager：
- load_scene(scene_path, init_data)
- unload_current_scene()
```

### 3.2 UI 分層系統

1. **背景層**：棋盤、敵人、基礎 UI 元素
2. **互動層**：拖曳預覽、按鈕、可操作元素
3. **資訊層**：HP、CD、combo、傷害數字
4. **浮動層**：彈窗、設定選單、結算畫面

### 3.3 狀態管理

**遊戲狀態枚舉**：
- `WAITING_INPUT`：等待玩家放置圖塊
- `PLACING_TILE`：正在拖曳圖塊
- `RESOLVING`：計算傷害與效果
- `ENEMY_TURN`：敵人行動階段
- `BATTLE_END`：戰鬥結束

**UI 響應狀態**：
- 不同狀態下禁用/啟用對應 UI 元素
- 提供清晰的狀態轉換視覺回饋

---

## 四、具體 UI 規格

### 4.1 統一三層佈局規格

#### 4.1.1 整體佈局 (基準解析度 1080×1920)
**所有介面採用重新平衡的三層結構**：
- **上層主要資訊顯示區**：位置 (0, 0)，尺寸 1080×1000px（最大）
- **中層統一互動確認區**：位置 (240, 1000)，尺寸 600×600px（放大版）
- **下層選項圖塊區**：位置 (0, 1600)，尺寸 1080×320px（緊湊版）

#### 4.1.2 上層主要資訊顯示區詳細規格 (1000px高)
- **背景色**：深藍漸層 (#1a1a2e → #16213e)
- **內容區域劃分**：
  - 標題區：(0, 0) - (1080, 150px)
  - 主要內容區：(0, 150) - (1080, 700px)
  - 互動元素區：(0, 700) - (1080, 1000px)
- **充裕空間用於**：
  - 詳細的敵人資訊和技能展示
  - 完整的戰鬥棋盤（戰鬥場景）
  - 豐富的關卡資訊展示（關卡選擇）
  - 完整的統計和獎勵資訊（結算畫面）

#### 4.1.3 中層統一互動確認區規格 (600×600px)
**所有介面使用相同規格**：
- **位置**：(240, 1000) 固定位置，水平居中
- **總尺寸**：600×600px
- **網格配置**：3×3，每格 200×200px
- **格子間距**：0px（緊密排列）
- **背景**：半透明黑色 (#000000AA)
- **圓角**：20px
- **邊框**：3px 實線 #444444
- **中央目標格**：
  - 位置：網格 (1,1)
  - 特殊效果：發光邊框 #FFD700
  - 脈動動畫：邊框透明度 0.5 ↔ 1.0
- **功能**：確認操作、預覽選擇項目

#### 4.1.4 下層選項圖塊區詳細規格 (320px高)
- **容器背景**：
  - 位置：(0, 1600)
  - 尺寸：1080×320px
  - 背景色：#2a2a3e
- **圖塊通用規格**：
  - 標準尺寸：200×200px（與棋盤格子完全對齊）
  - 圓角：20px
  - 邊框：4px
  - 圖標尺寸：120×120px，位置中央偏上 30px
  - 文字標籤：24px Bold，位置底部偏上 30px
- **控制按鈕規格**：
  - 主要按鈕：200×60px
  - 次要按鈕：80×60px

### 4.2 各介面具體規格

#### 4.2.1 主選單 (MainMenu) 具體佈局
**上層主要資訊顯示區內容 (1000px高)**：
- **遊戲 LOGO**：位置 (540, 200) 中心對齊，字體 64px Bold #FFD700
- **副標題**：位置 (540, 300)，「選擇你的命運方塊」，24px #CCCCCC
- **遊戲介紹區域**：位置 (540, 500)，背景 #FFFFFF20，圓角 20px
  - 遊戲玩法簡介
  - 特色功能說明
  - 更新資訊等
- **版本資訊**：位置 (1000, 950)，12px #888888

**中層互動確認區功能**：
- 顯示「拖放功能圖塊到此處」提示
- 選中功能後顯示功能預覽和確認按鈕

**下層功能圖塊排列 (320px高)**：
- **四個圖塊水平居中排列**：
  - 戰鬥圖塊：(140, 1620)，背景色 #FF4444
  - 構築圖塊：(360, 1620)，背景色 #4488FF
  - 商店圖塊：(580, 1620)，背景色 #FFD700
  - 設定圖塊：(800, 1620)，背景色 #888888

#### 4.2.2 關卡選擇 (LevelSelection) 具體佈局
**上層主要資訊顯示區內容 (1000px高)**：
- **章節標題**：位置 (540, 80)，32px Bold #FFFFFF
- **章節進度條**：位置 (540, 150)，800×30px，背景 #333333，填充 #44AA44
- **章節切換按鈕**：左 (80, 150)，右 (1000, 150)，80×50px
- **關卡詳細資訊面板**：位置 (540, 400)，尺寸 900×500px
  - 背景：半透明白色 #FFFFFF90，圓角 25px
  - 關卡名稱：大字標題
  - 敵人預覽：包含敵人立繪和詳細資訊
  - 獎勵資訊：金幣、經驗、道具預覽
  - 解鎖條件、建議戰力、特殊規則
  - 最佳紀錄和星級顯示

**中層互動確認區功能**：
- 顯示「拖放關卡圖塊開始遊戲」提示
- 選中關卡後顯示關卡縮略圖和確認/取消按鈕

**下層關卡圖塊滾動區 (320px高)**：
- **滾動容器**：位置 (40, 1620)，1000×280px
- **可視區域**：1000×240px，支援水平滾動和右滑查看
- **關卡圖塊規格**：
  - 尺寸：200×200px（與棋盤格子對齊）
  - 間距：20px
  - 可挑戰：背景 #FFFFFF，邊框 2px #CCCCCC
  - 已完成：背景 #E8F5E8，邊框 3px #44AA44，星級右上角
  - 未解鎖：背景 #F5F5F5，邊框 2px #999999，透明度 0.6
- **返回主選單按鈕**：位置 (80, 1880)，150×80px

#### 4.2.3 戰鬥場景 (Battle) 具體佈局
**上層主要戰鬥資訊顯示區內容 (1000px高)**：
- **關卡名稱**：位置 (540, 50)，28px Bold #FFFFFF
- **設定按鈕**：位置 (980, 50)，80×80px，右上角固定位置，背景 #666666
- **敵人立繪**：位置 (150, 200)，250×250px，圓形遮罩，邊框 4px #FFD700
- **敵人詳細資訊面板**：位置 (450, 150)
  - HP血條：500×50px，背景 #333333，填充 #FF4444，圓角 25px
  - 屬性圖標：50×50px，位置 HP條左側
  - 倒數CD：150×150px圓形，背景 #FF8800，數字 48px Bold #FFFFFF
- **英雄技能區**：位置 (800, 200)，預留多個技能按鈕，每個80×80px
- **傷害分解顯示區**：位置 (450, 400)
  - 本回合傷害預覽：28px Bold，大字顯示
  - 當前Combo數值：「連擊 x N」，24px Bold
  - 連擊倍率顯示：「倍率 x1.2」，20px
  - 屬性加成顯示：各屬性加成數值

**中層唯一戰鬥棋盤 (600×600px)**：
- **3×3戰鬥棋盤**：位置 (240, 1000)，與其他介面九宮格相同規格
- **單格尺寸**：200×200px，無間距
- **棋盤功能**：
  - 候選圖塊的拖放目標區域
  - 障礙格標示：背景 #333333，斜線紋理
  - 空格：背景 #F5F5F5，邊框 2px #DDDDDD
  - 放置高亮：可放置 #44FF4440，無效 #FF444440
  - 已放置圖塊顯示

**下層候選圖塊與控制區 (320px高)**：
- **候選圖塊區**：位置 (140, 1620)，4個檔位，每個200×200px
  - 顯示圖塊形狀與屬性
  - 支援拖曳到中層的3×3戰鬥棋盤
  - 使用後立即補充新圖塊
- **操作按鈕**：
  - 送出按鈕：位置 (440, 1830)，200×60px，背景 #FF6600
  - 取消按鈕：位置 (680, 1830)，160×60px，背景 #888888

#### 4.2.4 結算畫面 (Result) 具體佈局
**上層主要結果展示區內容 (1000px高)**：
- **勝利/失敗大字**：位置 (540, 150)，72px Bold #FFD700，文字陰影 6px
- **星級評價**：位置 (540, 250)，星星 120×120px，間距 40px
  - 金星 #FFD700，銀星 #C0C0C0，空星 #666666
- **詳細戰鬥統計面板**：位置 (540, 450)，尺寸 900×400px
  - 背景：#F8F8F8，圓角 25px，陰影效果
  - 總回合數 vs 目標回合數（大字顯示）
  - 最大連擊數和平均連擊
  - 總傷害輸出和每回合平均傷害
  - 剩餘HP和受到傷害（勝利時）
  - 完成時間和速度評級
  - 使用技能次數等詳細數據
- **獎勵展示區**：位置 (540, 850)，背景 #FFFFFF90，圓角 20px
  - 獲得金幣、經驗值、道具詳細展示
  - 解鎖的新內容提示

**中層互動確認區功能**：
- 顯示「選擇你的行動」提示
- 拖放行動圖塊後顯示行動預覽和確認效果
- 中央格可顯示選中行動的詳細說明

**下層行動圖塊選擇區 (320px高)**：
- **四個行動圖塊**：水平排列，每個200×200px
  - 重試圖塊：位置 (140, 1620)，橙色 #FF8800
  - 繼續圖塊：位置 (360, 1620)，綠色 #44AA44（勝利時顯示）
  - 返回圖塊：位置 (580, 1620)，藍色 #4488FF
  - 分享圖塊：位置 (800, 1620)，紫色 #AA44FF（預留功能）
- **返回主選單按鈕**：位置 (80, 1850)，150×80px

### 4.5 通用設計規範

#### 4.5.1 圖塊通用規格
- **可拖拽圖塊**：200×200px (與棋盤格子完全對齊)
- **圖塊內圖標**：120×120px (適配200×200px圖塊)
- **UI按鈕**：依功能需求而定 (如80×80px設定按鈕)
- **圓角半徑**：20px (圖塊)，10px (按鈕)
- **邊框寬度**：4px (強調)，3px (正常)，2px (次要)
- **陰影效果**：8px blur，透明度 30%，顏色 #000000

#### 4.5.2 間距系統
- **極小間距**：4px (格子內)
- **小間距**：8px (相關元素)
- **標準間距**：16px (普通間距)  
- **中間距**：24px (段落間)
- **大間距**：32px (區域間)
- **極大間距**：48px (主要區塊間)

#### 4.5.3 字體規格
- **超大標題**：64px Bold (結果標題)
- **大標題**：48px Bold (遊戲標題)  
- **中標題**：32px Bold (區域標題)
- **小標題**：24px Bold (項目標題)
- **正文**：18px Regular (按鈕文字)
- **小文字**：14px Regular (說明文字)
- **極小文字**：12px Regular (輔助資訊)

### 4.6 圖塊詳細設計規格

#### 4.6.1 戰鬥圖塊（屬性圖塊）詳細規格

**統一尺寸規格**：
- 所有戰鬥圖塊：200×200px（與棋盤格子完全對齊）
- 圖塊內圖標：120×120px
- 屬性文字：24px Bold

**火屬性圖塊**：
- 背景色：#FF4444
- 邊框：4px #AA0000
- 圖標位置：中央偏上 30px
- 圖標尺寸：120×120px (標準，適配200×200px圖塊)
- 屬性文字：底部中央，字體 24px Bold
- 拖曳狀態：透明度 0.8，陰影 12px #FF444460

**水屬性圖塊**：
- 背景色：#4444FF  
- 邊框：3px #0000AA
- 設計規格同火屬性

**草屬性圖塊**：
- 背景色：#44FF44
- 邊框：3px #00AA00  
- 設計規格同火屬性

**光屬性圖塊**：
- 背景色：#FFD700
- 邊框：3px #B8860B
- 特殊效果：發光光暈 4px #FFD70080
- 設計規格同火屬性

**暗屬性圖塊**：  
- 背景色：#8B44FF
- 邊框：3px #5722AA
- 特殊效果：暗影效果 6px #00000040
- 設計規格同火屬性

#### 4.6.2 功能圖塊（導航圖塊）詳細規格

**統一基礎規格**：
- 尺寸：200×200px（與棋盤格子完全對齊）
- 圓角：20px
- 邊框：4px
- 陰影：10px blur #00000035

**戰鬥圖塊詳細規格**：
- 背景色：線性漸層 #FF4444 → #CC2222
- 邊框色：#AA0000
- 圖標：劍盾交叉
  - 位置：中央偏上 20px
  - 尺寸：120×120px
  - 顏色：#FFFFFF
- 文字標籤：
  - 位置：底部中央偏上 30px
  - 內容：「戰鬥」
  - 字體：22px Bold
  - 顏色：#FFFFFF
- 懸停效果：背景亮度 +20%
- 按下效果：縮放 0.95，陰影減少到 6px

**構築圖塊詳細規格**：
- 背景色：線性漸層 #4488FF → #2266CC
- 邊框色：#0044AA
- 圖標：拼圖片組合
  - 位置：中央偏上 20px  
  - 尺寸：120×120px
  - 顏色：#FFFFFF
- 「敬請期待」狀態：
  - 透明度：0.6
  - 額外文字：「敬請期待」，16px，位置底部
  - 點擊無效果

**商店圖塊詳細規格**：
- 背景色：線性漸層 #FFD700 → #CC9900
- 邊框色：#B8860B
- 圖標：金幣堆疊
  - 位置：中央偏上 20px
  - 尺寸：120×120px  
  - 顏色：#FFFFFF
- 特殊效果：閃爍動畫（可選）
- 「敬請期待」狀態同構築圖塊

**設定圖塊詳細規格**：
- 背景色：線性漸層 #888888 → #555555
- 邊框色：#333333
- 圖標：齒輪
  - 位置：中央偏上 20px
  - 尺寸：120×120px
  - 顏色：#FFFFFF
- 懸停效果：齒輪旋轉動畫

#### 4.6.3 行動圖塊（結算用）詳細規格

**統一基礎規格**：
- 尺寸：200×200px（與棋盤格子對齊，100px的2倍）
- 圓角：20px  
- 邊框：4px
- 陰影：8px blur #00000030

**重試圖塊詳細規格**：
- 背景色：徑向漸層 #FF8800 → #CC5500
- 邊框色：#AA4400
- 圖標：重新開始箭頭（圓形）
  - 位置：中央偏上 20px
  - 尺寸：120×120px
  - 顏色：#FFFFFF
  - 動畫：旋轉動畫
- 文字：「重試」，底部中央偏上 30px，22px Bold

**繼續圖塊詳細規格**：
- 背景色：徑向漸層 #44AA44 → #226622  
- 邊框色：#004400
- 圖標：右箭頭
  - 位置：中央偏上 20px
  - 尺寸：120×120px
  - 顏色：#FFFFFF
- 文字：「繼續」，22px Bold
- 脈動效果：每 2 秒放大 1.05 倍

**返回圖塊詳細規格**：
- 背景色：徑向漸層 #4488FF → #2266BB
- 邊框色：#003366  
- 圖標：左箭頭
  - 位置：中央偏上 20px
  - 尺寸：120×120px
  - 顏色：#FFFFFF
- 文字：「返回」，22px Bold

**分享圖塊詳細規格**：
- 背景色：徑向漸層 #AA44FF → #7722BB
- 邊框色：#441166
- 圖標：分享符號（三角形+線條）
  - 位置：中央偏上 20px
  - 尺寸：120×120px
  - 顏色：#FFFFFF
- 文字：「分享」，22px Bold  
- 預留狀態：透明度 0.5，「開發中」文字

#### 4.6.4 關卡圖塊詳細規格

**統一基礎規格**：
- 尺寸：200×200px（與棋盤格子對齊，100px的2倍）
- 圓角：20px
- 陰影：6px blur #00000025

**可挑戰狀態**：
- 背景色：#FFFFFF
- 邊框：2px #CCCCCC  
- 關卡編號：
  - 位置：中央
  - 字體：32px Bold
  - 顏色：#333333
- 敵人預覽：
  - 位置：右上角 (140, 40)
  - 尺寸：30×30px
  - 圓形遮罩

**已完成狀態**：
- 背景色：線性漸層 #E8F5E8 → #D4EDD4
- 邊框：3px #44AA44
- 星級標記：
  - 位置：頂部中央下 30px
  - 星星尺寸：30×30px  
  - 間距：8px
  - 金星：#FFD700，銀星：#C0C0C0
- 完成時間：
  - 位置：底部中央上 25px
  - 字體：16px Regular
  - 顏色：#666666

**未解鎖狀態**：
- 背景色：#F5F5F5
- 邊框：2px #999999
- 透明度：0.6
- 鎖定圖標：
  - 位置：中央
  - 尺寸：60×60px
  - 顏色：#666666
- 解鎖條件文字：
  - 位置：底部中央上 20px
  - 字體：14px Regular  
  - 顏色：#888888

#### 4.6.5 拖放視覺反饋規格

**拖拽開始狀態**：
- 原圖塊透明度：0.5
- 拖拽預覽透明度：0.9
- 拖拽預覽陰影：12px blur #00000050
- 拖拽預覽縮放：1.1 倍

**有效投放區域**：
- 邊框：4px 實線 #44FF44
- 背景：#44FF4420
- 脈動動畫：邊框透明度 0.5 ↔ 1.0，週期 1 秒

**無效投放區域**：
- 邊框：4px 實線 #FF4444  
- 背景：#FF444420
- 震動效果：輕微左右搖擺

**投放成功動畫**：
- 縮放動畫：1.2 倍 → 1.0 倍，持續 0.3 秒
- 粒子效果：20個小光點向外擴散
- 吸附動畫：貝塞爾曲線移動到目標位置

**投放失敗動畫**：
- 回彈動畫：彈性回到原位置，持續 0.5 秒
- 震動提示：原位置輕微震動 0.2 秒

### 4.7 響應式佈局適配規格

#### 4.7.1 不同解析度適配

**基準解析度：1080×1920 (標準)**
- 所有尺寸按此設計

**高解析度：1440×2560 (放大 133%)**  
- 整體縮放係數：1.33
- 字體大小：×1.33
- 圖標尺寸：×1.33
- 間距：×1.33

**低解析度：720×1280 (縮小 67%)**
- 整體縮放係數：0.67
- 字體最小限制：12px (不再縮小)
- 圖塊最小限制：134×134px (200×0.67)
- 觸控區域最小：44×44px

#### 4.7.2 橫屏適配 (暫不支持，預留)
- 主選單：功能圖塊改為 2×2 排列
- 戰鬥場景：棋盤左側，操作區右側
- 關卡選擇：網格左側，圖塊列表右側

### 4.8 動畫與過渡效果規格

#### 4.8.1 場景切換動畫
- **淡入淡出**：持續時間 0.5 秒
- **滑動切換**：300px 距離，0.4 秒，緩出曲線
- **縮放切換**：0.8 倍 → 1.0 倍，0.3 秒

#### 4.8.2 按鈕交互動畫
- **按下**：縮放 0.95 倍，持續 0.1 秒
- **懸停**：亮度 +15%，持續 0.2 秒  
- **禁用**：透明度 0.5，灰度濾鏡

#### 4.8.3 拖放動畫時序
1. **拖拽開始** (0-0.1s)：透明度變化，陰影出現
2. **拖拽過程** (持續)：跟隨手指，區域高亮
3. **接近投放區** (觸發距離 50px)：吸附提示
4. **投放成功** (0.3s)：縮放+粒子效果  
5. **投放失敗** (0.5s)：回彈動畫

### 4.9 資訊顯示詳細規範

#### 4.9.1 數值顯示格式
- **HP 數值**：「800 / 1200」格式，分隔符前後各 1 個空格
- **傷害數值**：整數顯示，千分位逗號分隔
- **倒數顯示**：純數字，字體 48px Bold
- **連擊數值**：「Combo ×N」格式，N 為整數

#### 4.9.2 進度條設計規範
- **HP 血條**：
  - 高度：40px
  - 圓角：20px  
  - 背景色：#333333
  - 填充色：#FF4444 (血量) / #44FF44 (護盾)
  - 動畫：數值變化時 0.5 秒過渡

- **章節進度條**：
  - 高度：20px
  - 圓角：10px
  - 背景色：#333333  
  - 填充色：#44AA44
  - 文字疊加：「3/5」，居中，14px Bold

#### 4.9.3 狀態提示設計
- **成功提示**：
  - 背景色：#44AA44
  - 文字色：#FFFFFF  
  - 圖標：✓，24×24px
  - 顯示時間：2 秒

- **警告提示**：
  - 背景色：#FF8800
  - 文字色：#FFFFFF
  - 圖標：⚠，24×24px
  - 顯示時間：3 秒

- **錯誤提示**：  
  - 背景色：#FF4444
  - 文字色：#FFFFFF
  - 圖標：✗，24×24px
  - 顯示時間：4 秒

#### 4.9.4 載入與等待狀態
- **載入轉圈**：
  - 尺寸：60×60px
  - 線寬：6px  
  - 顏色：#FFD700
  - 轉速：1 秒/圈

- **載入文字**：
  - 「載入中...」，18px Regular
  - 位置：載入圈下方 20px
  - 顏色：#CCCCCC

### 4.10 觸控交互規範

#### 4.10.1 觸控區域最小尺寸
- **按鈕最小尺寸**：88×88px (44px 規則 ×2)
- **圖塊最小尺寸**：200×200px (標準統一尺寸)
- **滑動手勢最小區域**：200×200px

#### 4.10.2 手勢識別參數  
- **拖拽觸發距離**：16px
- **拖拽最小時間**：0.1 秒
- **點擊最大時間**：0.3 秒
- **雙擊間隔時間**：0.5 秒

#### 4.10.3 觸覺反饋設計 (預留)
- **按鈕點擊**：輕觸覺反饋，50ms
- **拖拽開始**：中等反饋，100ms  
- **投放成功**：強反饋，150ms
- **投放失敗**：錯誤反饋，雙脈衝

---

## 五、擴展性考慮

### 5.1 未來功能預留
- **技能系統**：戰鬥中增加技能圖塊拖放機制
- **多敵人支援**：敵人區域可擴展為列表，支援目標選擇
- **商店系統**：商店內使用拖放機制購買道具/英雄
- **隊伍構築**：拖放英雄和裝備到隊伍槽位
- **動畫系統**：所有拖放操作的流暢動畫過渡
- **音效整合**：統一的拖放音效系統

### 5.2 拖放系統擴展
- **新圖塊類型**：
  - 裝備圖塊（裝備管理）
  - 英雄圖塊（英雄選擇）
  - 道具圖塊（物品使用）
  - 技能圖塊（戰鬥技能）
- **新投放區域**：
  - 裝備槽（英雄裝備）
  - 技能欄（技能配置）
  - 倉庫格（物品存放）
  - 隊伍位（隊伍編成）

### 5.3 介面模組化
- **可重用組件**：
  - 通用九宮格投放區
  - 標準化圖塊樣式
  - 統一的拖放反饋
  - 模組化訊息提示
- **場景轉換**：統一的場景切換動畫
- **狀態保存**：拖放過程中的狀態持久化

### 5.4 多語系支援
- 圖塊文字標籤集中管理
- 圖標優先設計，減少文字依賴
- UI 佈局適應不同語言文字長度
- 拖放提示文字的多語系化

### 5.5 不同螢幕適配
- 九宮格大小根據螢幕尺寸動態調整
- 圖塊觸控區域保持最小可用尺寸
- 拖放距離閾值適配不同設備
- 文字和圖標大小的自適應縮放

---

## 六、開發優先序

### Phase 1 (MVP 核心) - 統一分層拖放系統
1. **統一三層架構**：
   - 上層資訊顯示區：1000px高，顯示各場景相關資訊
   - 中層統一九宮格：600×600px，所有場景使用相同規格
   - 下層圖塊選擇區：320px高，緊湊適應不同場景需求
2. **通用拖放系統**：
   - DragDropManager 基礎架構
   - DraggableTile 和 DropZone 基類
   - 統一的視覺反饋和拖放邏輯
3. **戰鬥場景重新設計**：
   - 上層：敵人資訊 + 傷害Combo顯示 + 技能按鈕
   - 中層：3×3戰鬥棋盤（600×600px，單格200×200px）
   - 下層：4個候選圖塊（200×200px與格子對齊）+ 操作按鈕

### Phase 2 (導航系統完善) - 統一UI體驗
1. **完整導航流程**：
   - 主選單 → 關卡選擇 → 戰鬥 → 結算
   - 每個場景都有返回機制和統一的確認/取消
2. **關卡選擇系統**：
   - 關卡圖塊拖放選擇 + 詳細資訊顯示
   - 確認/取消按鈕機制
   - 進度和解鎖狀態顯示
3. **結算畫面完善**：
   - 行動圖塊拖放選擇
   - 完整的結果展示和統計
4. **視覺效果統一**：
   - 所有場景使用相同的拖放動畫
   - 統一的九宮格高亮效果

### Phase 3 (體驗優化) - 細節完善
1. **視覺效果強化**：
   - 拖放動畫優化
   - 粒子效果和過渡動畫
   - 圖塊吸附和彈跳效果
2. **音效系統**：
   - 統一的拖放音效
   - 場景切換音效
   - 背景音樂整合
3. **用戶體驗優化**：
   - 操作提示和教學
   - 錯誤處理和回饋
   - 無障礙設計考慮

### Phase 4 (擴展功能) - 進階特性
1. **商店系統**：拖放式購買介面
2. **隊伍構築**：拖放式英雄和裝備管理
3. **技能系統**：戰鬥中的技能圖塊拖放
4. **社交功能**：分享和排行榜等

---

## 七、測試檢查點

### 7.1 統一分層架構測試
- [ ] 所有場景都使用重新平衡的三層結構
- [ ] 上層主要資訊顯示區高度統一為1000px（最大）
- [ ] 中層統一確認區尺寸統一為600×600px，位置固定在(240, 1000)
- [ ] 下層選項區位置統一在(0, 1600)，高度320px（緊湊）
- [ ] 所有九宮格單格規格統一：200×200px，無間距
- [ ] 所有場景的確認區視覺效果一致
- [ ] 戰鬥場景的3×3棋盤在中層，候選圖塊在下層，圖塊尺寸與格子相同

### 7.2 拖放系統測試
- [ ] 所有圖塊都能正常拖拽到統一九宮格
- [ ] 九宮格投放區域正確識別和高亮
- [ ] 無效投放正確回彈到原始位置
- [ ] 拖放視覺反饋在所有場景保持一致
- [ ] 中央確認格的高亮效果統一

### 7.3 導航功能測試
- [ ] 主選單四個功能圖塊拖放導航正常
- [ ] 關卡選擇：拖放關卡圖塊→顯示詳細資訊→確認/取消機制
- [ ] 結算畫面：拖放行動圖塊選擇後續行動
- [ ] 每個場景都有返回主選單的方法
- [ ] 場景切換流暢無卡頓

### 7.4 戰鬥系統測試
- [ ] 戰鬥圖塊可正常拖放到中層的唯一3×3戰鬥棋盤
- [ ] 只有一個棋盤，不存在重複的棋盤區域
- [ ] 上層區域顯示敵人資訊、技能按鈕、傷害分解和設定按鈕（右上角）
- [ ] 中層的3×3棋盤既是拖放目標也是確認區域
- [ ] 傷害分解、Combo、技能按鈕都在上層合理分佈
- [ ] 3×3戰鬥棋盤與其他介面的九宮格規格完全一致（600×600px）
- [ ] 下層候選圖塊尺寸200×200px與棋盤格子相同，便於理解拖放關係
- [ ] 候選圖塊和棋盤格子1:1對應，視覺直觀
- [ ] 設定按鈕固定在右上角，屬於上層區域

### 7.5 關卡選擇系統測試
- [ ] 拖放關卡圖塊到九宮格顯示詳細資訊
- [ ] 確認/取消按鈕在選中關卡後正確顯示
- [ ] 關卡圖塊水平滾動機制正常
- [ ] 關卡解鎖狀態和星級顯示正確
- [ ] 返回主選單按鈕功能正常

### 7.6 用戶體驗測試
- [ ] 所有場景的九宮格大小和位置感受一致
- [ ] 拖放操作直觀易懂，學習曲線平滑
- [ ] 視覺反饋清晰明確，統一性良好
- [ ] 圖塊大小適合觸控操作
- [ ] 不同螢幕尺寸適配良好

### 7.7 完整流程測試
- [ ] 主選單→關卡選擇→戰鬥→結算完整流程
- [ ] 每個場景都能正確返回上一個場景
- [ ] 勝利/失敗處理正確，行動選擇正常
- [ ] 關卡進度正確保存
- [ ] 拖放狀態在場景切換時正確重置

---

## 八、拖放系統技術細節

### 8.1 核心組件設計

#### 8.1.1 DragDropManager (Autoload)
```gdscript
# 全域拖放管理器
extends Node

signal tile_drag_started(tile_data, source_scene)
signal tile_drag_ended(tile_data, drop_zone, success)
signal navigation_requested(target_scene, tile_type)

var current_dragging_tile: DraggableTile = null
var valid_drop_zones: Array[DropZone] = []
var drag_preview: Control = null
```

#### 8.1.2 DraggableTile (Base Class)
```gdscript
# 可拖拽圖塊基類
extends Control
class_name DraggableTile

@export var tile_type: String = ""
@export var tile_data: Dictionary = {}
@export var return_on_invalid_drop: bool = true

signal drag_started()
signal drag_ended(success: bool)
```

#### 8.1.3 DropZone (Base Class)
```gdscript
# 投放區域基類
extends Control
class_name DropZone

@export var accepted_tile_types: Array[String] = []
@export var zone_type: String = ""

signal tile_dropped(tile_data: Dictionary)
signal tile_hover_enter(tile_data: Dictionary)
signal tile_hover_exit()
```

### 8.2 場景特化組件

#### 8.2.1 NavigationTile (導航圖塊)
```gdscript
extends DraggableTile
class_name NavigationTile

@export var target_scene_path: String = ""
@export var navigation_data: Dictionary = {}
```

#### 8.2.2 LevelTile (關卡圖塊)
```gdscript
extends DraggableTile
class_name LevelTile

@export var level_id: String = ""
@export var is_unlocked: bool = false
@export var completion_stars: int = 0
```

#### 8.2.3 ActionTile (行動圖塊)
```gdscript
extends DraggableTile
class_name ActionTile

@export var action_type: String = "" # "retry", "continue", "back", "share"
@export var action_data: Dictionary = {}
```

### 8.3 統一拖放行為

**拖放生命週期**：
1. `_gui_input()` 檢測拖拃開始
2. `DragDropManager.start_drag()` 創建預覽
3. 更新預覽位置和高亮有效區域  
4. 檢測投放區域並驗證有效性
5. 執行投放動作或回彈動畫
6. 清理拖放狀態

**視覺反饋標準**：
- 拖拃開始：圖塊變半透明，顯示拖拃預覽
- 懸停有效區域：投放區域高亮綠色
- 懸停無效區域：投放區域高亮紅色  
- 投放成功：播放吸附動畫和粒子效果
- 投放失敗：播放回彈動畫

---

## 九、相關文件

### 9.1 技術實作
詳細的Godot節點設定、腳本實作和程式碼請參考：
- [Godot 實作規格書](./Godot_Implementation_Specification.md)

### 9.2 開發計劃
開發時程和任務分配請參考：
- [MVP 30天開發計畫](./MVP_30Day_Workflow.md)

### 9.3 技術需求
完整的技術需求和規格請參考：
- [MVP 問卷與需求](./MVP_Questionnaire.md)
- [遊戲系統需求規格書](./Game_SRS.md)

---

## 十、美術資源需求

### 10.1 圖標資源 (Icons)

#### 10.1.1 功能圖標
**主選單功能圖塊圖標**：
- `sword_shield.png` - 戰鬥圖標 (120×120px)
- `puzzle_piece.png` - 構築圖標 (120×120px)  
- `gold_coins.png` - 商店圖標 (120×120px)
- `gear.png` - 設定圖標 (120×120px)

**操作圖標**：
- `retry_arrow.png` - 重試圖標 (120×120px，圓形箭頭)
- `continue_arrow.png` - 繼續圖標 (120×120px，右箭頭)
- `back_arrow.png` - 返回圖標 (120×120px，左箭頭)
- `share_icon.png` - 分享圖標 (120×120px，分享符號)

**狀態圖標**：
- `lock.png` - 鎖定圖標 (60×60px)
- `star_gold.png` - 金星 (30×30px 和 120×120px 兩種尺寸)
- `star_silver.png` - 銀星 (30×30px 和 120×120px 兩種尺寸)  
- `star_empty.png` - 空星 (30×30px 和 120×120px 兩種尺寸)

#### 10.1.2 屬性圖標
**元素屬性** (60×60px 和 120×120px 兩種尺寸)：
- `element_fire.png` - 火屬性圖標
- `element_water.png` - 水屬性圖標
- `element_grass.png` - 草屬性圖標
- `element_light.png` - 光屬性圖標
- `element_dark.png` - 暗屬性圖標

#### 10.1.3 英雄與凸塊資源
**主英雄圖塊**：
- `hero_main.png` - 主英雄頭像 (200×200px)
- `hero凸塊_1.png` ~ `hero凸塊_8.png` - 八種凸塊圖案 (每種 200×200px)
- `hero凸塊_icon.png` - 總覽用小圖標 (120×120px)

**英雄屬性/狀態**：
- `hero_hp_bar.png` - 英雄血條
- `hero_skill_icon.png` - 英雄技能圖標

### 10.2 敵人資源 (Enemies)

#### 10.2.1 敵人完整圖
**戰鬥場景用** (200×200px，建議 PNG 格式帶透明背景)：
- `slime_001.png` - 史萊姆 (第一章基礎敵人)
- `goblin_001.png` - 哥布林 
- `orc_001.png` - 獸人
- (後續敵人可依開發進度追加)

#### 10.2.2 敵人預覽圖
**關卡選擇用** (30×30px，縮小版)：
- `slime_preview.png` - 史萊姆預覽
- `goblin_preview.png` - 哥布林預覽
- `orc_preview.png` - 獸人預覽

### 10.3 UI 裝飾資源

#### 10.3.1 背景圖案
- `main_menu_bg.png` - 主選單背景 (1080×1920px)
- `battle_bg.png` - 戰鬥場景背景 (1080×1920px)
- `level_select_bg.png` - 關卡選擇背景 (1080×1920px)

#### 10.3.2 裝飾元素
- `frame_gold.png` - 金色邊框裝飾
- `particle_star.png` - 星形粒子效果 (4×4px)
- `grid_pattern.png` - 棋盤網格紋理
- `diagonal_lines.png` - 斜線紋理 (用於障礙格)

### 10.4 圖塊紋理資源

#### 10.4.1 戰鬥圖塊面
**多格圖塊的圖案** (每格 200×200px 或更大以支援縮放)：
- 不同形狀的圖塊面設計
- 可選擇使用純色+邊框，或者帶有紋理的設計
- 建議製作可拼接的重複紋理

### 10.5 字體資源

#### 10.5.1 中文字體
- `NotoSansTC-Bold.ttf` - 粗體，用於標題和重要文字
- `NotoSansTC-Regular.ttf` - 常規體，用於一般文字

#### 10.5.2 數字字體 (可選)
- `RobotoMono-Bold.ttf` - 等寬字體，用於數值顯示

### 10.6 特效資源

#### 10.6.1 Shader 材質
- `CircleMask.tres` - 圓形遮罩材質 (用於敵人頭像)
- `GlowEffect.tres` - 發光效果材質
- `PulseEffect.tres` - 脈動效果材質

### 10.7 音效資源 (Audio)

#### 10.7.1 UI 音效
- `drag_start.ogg` - 拖拽開始音效
- `drag_success.ogg` - 成功投放音效
- `drag_fail.ogg` - 投放失敗音效
- `button_click.ogg` - 按鈕點擊音效
- `scene_transition.ogg` - 場景切換音效

#### 10.7.2 遊戲音效
- `damage_dealt.ogg` - 造成傷害音效
- `enemy_attack.ogg` - 敵人攻擊音效
- `victory.ogg` - 勝利音效
- `defeat.ogg` - 失敗音效

#### 10.7.3 背景音樂
- `main_menu_bgm.ogg` - 主選單背景音樂
- `battle_bgm.ogg` - 戰鬥背景音樂

---

## 十一、美術資源製作指南

### 11.1 設計原則

#### 11.1.1 視覺風格
- **色彩風格**：明亮、有活力的色彩搭配
- **設計風格**：扁平化設計，清晰的輪廓線
- **一致性**：所有圖標使用相同的設計語言
- **易識別**：圖標在小尺寸下仍清楚可辨

#### 11.1.2 技術規格
- **格式**：PNG (需要透明背景)，JPG (不需要透明背景)
- **色彩模式**：RGB，sRGB 色彩空間
- **解析度**：提供指定尺寸，可提供 2x 高解析度版本
- **壓縮**：適度壓縮，平衡檔案大小和品質

### 11.2 優先製作順序

#### 11.2.1 Phase 1 (MVP 必需)
1. **功能圖標** (4個主選單圖標)
2. **基礎敵人圖** (至少 1-2 隻)
3. **屬性圖標** (5個元素)
4. **操作圖標** (重試、繼續、返回)
5. **基礎 UI 音效** (拖放相關)

#### 11.2.2 Phase 2 (體驗優化)
1. **更多敵人圖**
2. **背景圖案**
3. **裝飾元素**
4. **特效材質**
5. **完整音效**

#### 11.2.3 Phase 3 (完整版)
1. **高品質背景**
2. **動畫序列圖**
3. **粒子效果圖**
4. **背景音樂**

### 11.3 臨時解決方案

#### 11.3.1 開發初期可用
- **純色圖塊**：使用 Godot 的 StyleBoxFlat 純色設計
- **內建圖標**：使用 Godot 內建的簡單圖標
- **文字標籤**：暫時用文字代替圖標
- **免費資源**：使用 Kenney.nl 或其他免費遊戲素材

#### 11.3.2 測試用占位符
```gdscript
# 在缺少圖片時的備用方案
var icon_texture = preload("res://art/icons/sword_shield.png") 
if icon_texture == null:
    # 使用純色矩形代替
    var color_rect = ColorRect.new()
    color_rect.color = Color.RED
    color_rect.size = Vector2(60, 60)
    add_child(color_rect)
else:
    var texture_rect = TextureRect.new()
    texture_rect.texture = icon_texture
    add_child(texture_rect)
```

### 11.4 資源管理建議

#### 11.4.1 檔案命名規範
- 使用英文小寫 + 底線
- 包含尺寸資訊：`icon_battle_60x60.png`
- 版本控制：`enemy_slime_v01.png`

#### 11.4.2 資料夾結構
```
res://art/
├── icons/
│   ├── functions/     # 功能圖標
│   ├── elements/      # 屬性圖標
│   ├── actions/       # 操作圖標
│   └── ui/           # 其他 UI 圖標
├── enemies/
│   ├── full/         # 完整敵人圖 200x200
│   └── previews/     # 預覽圖 30x30
├── backgrounds/
├── effects/
└── tiles/
```

---

## 十二、八個凸塊+一英雄的資源需求與純代碼實現

### 12.1 美術資源需求

#### 12.1.1 英雄圖塊
- `hero_main.png` - 主英雄頭像 (200×200px)
- `hero凸塊_1.png` ~ `hero凸塊_8.png` - 八種凸塊圖案 (每種 200×200px)
- `hero凸塊_icon.png` - 總覽用小圖標 (120×120px)

#### 12.1.2 英雄屬性/狀態
- `hero_hp_bar.png` - 英雄血條
- `hero_skill_icon.png` - 英雄技能圖標

### 12.2 純代碼實現建議

#### 12.2.1 英雄與凸塊圖塊
- 使用不同顏色的 `StyleBoxFlat` 代表八種凸塊：
  - 例如：紅、藍、綠、黃、紫、橙、青、灰
- 用 `Label` 顯示凸塊編號或屬性文字
- 主英雄用較大尺寸、特殊顏色或加粗邊框區分

#### 12.2.2 範例 GDScript 實現
```gdscript
# 英雄圖塊（純代碼）
var hero_tile = ColorRect.new()
hero_tile.color = Color(1, 0.8, 0.2) # 金色
hero_tile.size = Vector2(200, 200)
hero_tile.add_child(Label.new())
hero_tile.get_child(0).text = "主英雄"
hero_tile.get_child(0).horizontal_alignment = HORIZONTAL_ALIGNMENT_CENTER
hero_tile.get_child(0).vertical_alignment = VERTICAL_ALIGNMENT_CENTER
add_child(hero_tile)

# 八個凸塊圖塊（純代碼）
for i in range(8):
    var block_tile = ColorRect.new()
    block_tile.color = Color.from_hsv(i/8.0, 0.8, 0.9) # 彩虹色
    block_tile.size = Vector2(200, 200)
    var label = Label.new()
    label.text = "凸塊" + str(i+1)
    label.horizontal_alignment = HORIZONTAL_ALIGNMENT_CENTER
    label.vertical_alignment = VERTICAL_ALIGNMENT_CENTER
    block_tile.add_child(label)
    add_child(block_tile)
```

#### 12.2.3 UI設計建議
- 英雄圖塊放在操作區或棋盤旁邊，凸塊圖塊可作為可拖放元素
- 先用顏色和文字區分，等美術資源到位再替換

---

*本文件將隨開發進度持續更新*